Some weights of the model checkpoint at dbmdz/bert-base-german-cased were not used when initializing BertForSequenceClassification: ['cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dbmdz/bert-base-german-cased and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
number of total samples ----------> 21779
label2idx and idx2label:----------> {'<f/>': 0, '<e/>': 1, '<rps/>': 2} {0: '<f/>', 1: '<e/>', 2: '<rps/>'}
number of unique word 2602
Generation train and validaiton loader for training for number of samples 21779
length of training dataset 15245
length of validation dataset 3266 
length of test dataset 3268
  0%|                                                                                                                                                                                     | 0/3815 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
{'loss': 0.6788, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.13}                                                                                                                                            
{'loss': 0.2151, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.26}                                                                                                                                            
{'loss': 0.1671, 'learning_rate': 1.2e-05, 'epoch': 0.39}                                                                                                                                                          
{'loss': 0.1932, 'learning_rate': 1.6000000000000003e-05, 'epoch': 0.52}                                                                                                                                           
{'loss': 0.1725, 'learning_rate': 2e-05, 'epoch': 0.66}                                                                                                                                                            
{'loss': 0.1554, 'learning_rate': 1.9396681749622927e-05, 'epoch': 0.79}                                                                                                                                           
{'loss': 0.1939, 'learning_rate': 1.8793363499245855e-05, 'epoch': 0.92}                                                                                                                                           
 20%|██████████████████████████████████▏                                                                                                                                        | 763/3815 [01:20<04:49, 10.55it/s[0 0 0 ... 0 0 0]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 406/409 [00:03<00:00, 127.44it/s]
[0 0 0 ... 0 0 0]
{'eval_loss': 0.18004488945007324, 'eval_precision': 0.9589712186160441, 'eval_recall': 0.9589712186160441, 'eval_f1': 0.9589712186160442, 'eval_accuracy': 0.9589712186160441, 'eval_report': {'<f/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<e/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<rps/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'micro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'macro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'weighted avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}}, 'eval_runtime': 4.9173, 'eval_samples_per_second': 664.181, 'eval_steps_per_second': 83.175, 'epoch': 1.0}
{'loss': 0.193, 'learning_rate': 1.819004524886878e-05, 'epoch': 1.05}                                                                                                                                             
{'loss': 0.1692, 'learning_rate': 1.7586726998491705e-05, 'epoch': 1.18}                                                                                                                                           
{'loss': 0.1478, 'learning_rate': 1.6983408748114633e-05, 'epoch': 1.31}                                                                                                                                           
{'loss': 0.1696, 'learning_rate': 1.6380090497737558e-05, 'epoch': 1.44}                                                                                                                                           
{'loss': 0.2129, 'learning_rate': 1.5776772247360483e-05, 'epoch': 1.57}                                                                                                                                           
{'loss': 0.1679, 'learning_rate': 1.517345399698341e-05, 'epoch': 1.7}                                                                                                                                             
{'loss': 0.1847, 'learning_rate': 1.4570135746606336e-05, 'epoch': 1.83}                                                                                                                                           
{'loss': 0.1734, 'learning_rate': 1.3966817496229261e-05, 'epoch': 1.97}                                                                                                                                           
 40%|███████████████████████████████████████████████████████████████████▉                                                                                                      | 1525/3815 [02:51<03:56,  9.68it/s[0 0 0 ... 0 0 0]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 406/409 [00:03<00:00, 127.56it/s]
[0 0 0 ... 0 0 0]
{'eval_loss': 0.17548350989818573, 'eval_precision': 0.9592774035517453, 'eval_recall': 0.9592774035517453, 'eval_f1': 0.9592774035517453, 'eval_accuracy': 0.9592774035517453, 'eval_report': {'<f/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<e/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<rps/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'micro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'macro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'weighted avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}}, 'eval_runtime': 4.8591, 'eval_samples_per_second': 672.137, 'eval_steps_per_second': 84.172, 'epoch': 2.0}
{'loss': 0.1852, 'learning_rate': 1.3363499245852188e-05, 'epoch': 2.1}                                                                                                                                            
{'loss': 0.1742, 'learning_rate': 1.2760180995475113e-05, 'epoch': 2.23}                                                                                                                                           
{'loss': 0.1662, 'learning_rate': 1.215686274509804e-05, 'epoch': 2.36}                                                                                                                                            
{'loss': 0.1651, 'learning_rate': 1.1553544494720966e-05, 'epoch': 2.49}                                                                                                                                           
{'loss': 0.1595, 'learning_rate': 1.0950226244343893e-05, 'epoch': 2.62}                                                                                                                                           
{'loss': 0.1621, 'learning_rate': 1.0346907993966819e-05, 'epoch': 2.75}                                                                                                                                           
{'loss': 0.1797, 'learning_rate': 9.743589743589744e-06, 'epoch': 2.88}                                                                                                                                            
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                                                    | 2289/3815 [04:12<02:24, 10.57it/s[0 0 0 ... 0 0 0]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 406/409 [00:03<00:00, 127.57it/s]
[0 0 0 ... 0 0 0]
{'eval_loss': 0.18160732090473175, 'eval_precision': 0.9592774035517453, 'eval_recall': 0.9592774035517453, 'eval_f1': 0.9592774035517453, 'eval_accuracy': 0.9592774035517453, 'eval_report': {'<f/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<e/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<rps/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'micro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'macro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'weighted avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}}, 'eval_runtime': 5.831, 'eval_samples_per_second': 560.114, 'eval_steps_per_second': 70.143, 'epoch': 3.0}
{'loss': 0.1478, 'learning_rate': 9.14027149321267e-06, 'epoch': 3.01}                                                                                                                                             
{'loss': 0.171, 'learning_rate': 8.536953242835596e-06, 'epoch': 3.15}                                                                                                                                             
{'loss': 0.1639, 'learning_rate': 7.933634992458522e-06, 'epoch': 3.28}                                                                                                                                            
{'loss': 0.1545, 'learning_rate': 7.330316742081448e-06, 'epoch': 3.41}                                                                                                                                            
{'loss': 0.146, 'learning_rate': 6.7269984917043755e-06, 'epoch': 3.54}                                                                                                                                            
{'loss': 0.1443, 'learning_rate': 6.123680241327301e-06, 'epoch': 3.67}                                                                                                                                            
{'loss': 0.1703, 'learning_rate': 5.520361990950227e-06, 'epoch': 3.8}                                                                                                                                             
{'loss': 0.1592, 'learning_rate': 4.917043740573153e-06, 'epoch': 3.93}                                                                                                                                            
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 3051/3815 [05:35<01:15, 10.15it/s[0 0 0 ... 0 0 0]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 406/409 [00:03<00:00, 127.44it/s]
[0 0 0 ... 0 0 0]
{'eval_loss': 0.17302659153938293, 'eval_precision': 0.9605021432945499, 'eval_recall': 0.9605021432945499, 'eval_f1': 0.9605021432945499, 'eval_accuracy': 0.9605021432945499, 'eval_report': {'<f/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<e/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<rps/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'micro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'macro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'weighted avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}}, 'eval_runtime': 4.8927, 'eval_samples_per_second': 667.53, 'eval_steps_per_second': 83.595, 'epoch': 4.0}
{'loss': 0.162, 'learning_rate': 4.313725490196079e-06, 'epoch': 4.06}                                                                                                                                             
{'loss': 0.1632, 'learning_rate': 3.710407239819005e-06, 'epoch': 4.19}                                                                                                                                            
{'loss': 0.1538, 'learning_rate': 3.107088989441931e-06, 'epoch': 4.33}                                                                                                                                            
{'loss': 0.1551, 'learning_rate': 2.503770739064857e-06, 'epoch': 4.46}                                                                                                                                            
{'loss': 0.1572, 'learning_rate': 1.9004524886877828e-06, 'epoch': 4.59}                                                                                                                                           
{'loss': 0.1426, 'learning_rate': 1.2971342383107092e-06, 'epoch': 4.72}                                                                                                                                           
{'loss': 0.1568, 'learning_rate': 6.938159879336351e-07, 'epoch': 4.85}                                                                                                                                            
{'loss': 0.1533, 'learning_rate': 9.04977375565611e-08, 'epoch': 4.98}                                                                                                                                             
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3815/3815 [06:56<00:00, 10.53it/s[0 0 0 ... 0 0 0]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 406/409 [00:03<00:00, 126.48it/s]
[0 0 0 ... 0 0 0]
{'eval_loss': 0.17767126858234406, 'eval_precision': 0.9605021432945499, 'eval_recall': 0.9605021432945499, 'eval_f1': 0.9605021432945499, 'eval_accuracy': 0.9605021432945499, 'eval_report': {'<f/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<e/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, '<rps/>': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'micro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'macro avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}, 'weighted avg': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0}}, 'eval_runtime': 4.9026, 'eval_samples_per_second': 666.183, 'eval_steps_per_second': 83.426, 'epoch': 5.0}
{'train_runtime': 421.382, 'train_samples_per_second': 180.893, 'train_steps_per_second': 9.054, 'train_loss': 0.18111798316435607, 'epoch': 5.0}                                                                  
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3815/3815 [07:01<00:00,  9.05it/s]
metrics ================> {'train_runtime': 421.382, 'train_samples_per_second': 180.893, 'train_steps_per_second': 9.054, 'train_loss': 0.18111798316435607, 'epoch': 5.0, 'train_samples': 15245}
***** train metrics *****
  epoch                    =        5.0
  train_loss               =     0.1811
  train_runtime            = 0:07:01.38
  train_samples            =      15245
  train_samples_per_second =    180.893
  train_steps_per_second   =      9.054
*** Evaluate ***
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 405/409 [00:03<00:00, 125.75it/s][0 0 0 ... 0 0 0]
[0 0 0 ... 0 0 0]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 409/409 [00:04<00:00, 83.45it/s]
***** eval metrics *****
  epoch                   =                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.0
  eval_accuracy           =                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.9605
  eval_f1                 =                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.9605
  eval_loss               =                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.1777
  eval_precision          =                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.9605
  eval_recall             =                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.9605
Traceback (most recent call last):
  File "/home/phantom/Desktop/DD_german/language_model/bert.py", line 148, in <module>
    trainer.log_metrics("eval", metrics)
  File "/home/phantom/miniconda3/envs/pyt/lib/python3.11/site-packages/transformers/trainer_pt_utils.py", line 985, in log_metrics
    print(f"  {key: <{k_width}} = {metrics_formatted[key]:>{v_width}}")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to dict.__format__

